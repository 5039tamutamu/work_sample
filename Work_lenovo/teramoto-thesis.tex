\documentclass[a4j,12pt]{jreport}
\usepackage{graphicx,islab-thesis}
\usepackage{boxedminipage}
\usepackage{listings, jlisting}
\usepackage{framed}
\usepackage{ascmac}

\thesis{2021年度 卒業論文}
\date{2022年2月3日(木)}
\title{脳血流データによる四項目の思考タスクの\\識別方法に関する研究}
\department{早稲田大学基幹理工学部\\電子物理システム学科} 
\professor{柳澤 政生}
\studentnumber{1w182226-4}
\author{寺本 周平}
\authore{Shuhei Teramoto}
\date{2022年2月}
\lstset{
  language=C,
  basicstyle={\small},
  identifierstyle={\small},
  commentstyle={\small\itshape},
  keywordstyle={\small\bfseries},
  ndkeywordstyle={\small},
  stringstyle={\small\ttfamily},
  breaklines=true,
  columns=[l]{fullflexible},
  numbers=left,
  xrightmargin=0zw,
  xleftmargin=3zw,
  numberstyle={\scriptsize},
  stepnumber=1,
  numbersep=1zw,
  lineskip=-0.5ex,
  showstringspaces=false
}

\begin{document}
\maketitle
\tableofcontents
\chapter{序論}
\section{本論文の背景と目的}
　BMI(Brain Machine Interface)はリハビリテーション医学として研究されてきた．BMIとは脳でイメージした内容を識別し，その内容を機械が実行するという技術であり，麻痺により体を自由に動かせない人に利用される．従来は，体に障害がある機能の補助として利用される機能代償型BMIの開発が主に行われてきた．しかし近年，脳でイメージしてその内容に従い機械が動くことで，中枢神経の可塑的変化をもたらし，麻痺自体を治療することを可能にするという機能回復型BMIとしての可能性が見出されている[1]．本論文では，脳でイメージした内容を識別する段階について述べる．\\
　脳でイメージしてBMIの機械を動かすまでの流れを説明する．最初に脳波や脳血流といった脳データを計測する．その後脳データを識別し，その識別結果に基づきBMIの機械が動く．脳波の主な計測方法としてEEG(Electroencephalogram)，MEG(Magneto Encephalo Graphy)，脳血流の主な計測方法としてNIRS(Near Infrared Spectroscopy)，MRI(Magnetite Resonance Imaging)，PET(Positron Emission Tomography)がある．MEG，MRI，PETは大型装置であり，計測方法や場所が限られている．一方，EEG，NIRSは小型であり計測しながらの移動も容易であるためBMIの実用化に適している[2]．\\
　EEGにより計測できる脳波は，脳神経の電気信号であるため時間応答性が良く時間分解能に優れている．しかし脳波は電気信号の総和から脳の活動領域を読み取るため，空間分解能に劣っている．それに対してNIRSにより計測できる脳血流は，時間分解能に劣っているが，空間分解能に優れている．このメカニズムは，第2.2節「脳血流の特徴」にて説明する．以上より，EEGとNIRSは互いに相反する特徴を持ち，またEEGは電気信号を扱いNIRSは光を扱うため互いに影響を及ぼさないので，この二つにより同時に計測する手法が現在注目されている[2]．EEGによる脳波の計測は古くから研究されてきたが，NIRSによる脳血流の計測に関する研究は近年注目され始めており，まだ数多くの研究が行われていない[3]．また，NIRSにより計測された脳血流データの識別に関する先行研究は二項目の識別が多く(Nazeerらの研究[4]や柳沢らの研究[5]など)，脳血流データを用いたBMIを実用化するためにはさらに多くの内容を識別する必要がある．よって，本論文ではNIRSにより計測された脳血流データによる四項目の思考タスク(右手の運動イメージ，左手の運動イメージ，暗算，休憩)を高い正答率で識別することを目的とする．\\

\section{本論文の概要}
　本論文では，脳血流データの識別結果の比較を行う．本論文は7章で構成される．以下に各章の概要を示す．\\
　第2章「脳血流とNIRS」では，近年BMIに用いられている脳血流や,  脳血流を計測する機器であるNIRSについて述べる．\\
　第3章「公開脳血流データセット」では，第4章で紹介する先行研究や，第5，6章で紹介する自ら行った研究で使用している，Shinらにより計測された公開されている脳血流データセット[6]について紹介する．\\
　第4章「先行研究」では，共に運動野である左手，右手の運動イメージの識別を行っているShinらの研究[7]や，左手，右手の運動イメージ，暗算，休憩の四項目の思考タスクの識別を行っているGhafferらの研究[8]を紹介する．\\
　第5章「脳血流データの右手，左手の運動イメージの識別方法」では，Shinらの脳血流データセット[6]のうち，右手と左手の運動イメージの脳血流データを識別し考察した結果について述べる．\\
　第6章「脳血流データの右手，左手の運動イメージ，暗算，休憩の識別方法」では，Shinらの脳血流データセット[6]の，右手と左手の運動イメージ，暗算，休憩の四項目の脳血流データを識別し考察した結果について述べる．\\
　第7章「結論」では，本論文のまとめと今後の展望について述べる．\\

\chapter{脳血流とNIRS}
\section{本章の概要}
　本章では，近年BMIに使用されている脳血流と，脳血流を計測する機器であるNIRSについて説明する．\\
　第2.2節「脳血流の特徴」では，近年BMIに使用されている脳血流の特徴について説明する．\\
　第2.3節「NIRS(Near Infrared Spectroscopy)の原理」では，脳血流を計測する機器であるNIRSの原理について説明する．\\
 第2.4節「本章のまとめ」では，本章の総括を行う．\\

\section{脳血流の特徴}
　脳の神経活動は，大脳皮質の特定領域の脳血流の変化をもたらす．この脳血流の変化率は神経活動に依存している[9]．被験者がタスクを行い，脳の神経活動が行われると，その周辺では酸化ヘモグロビンの濃度が上昇し，還元ヘモグロビンの濃度が減少する．そのため酸化ヘモグロビンと還元ヘモグロビンの濃度を計測することにより，タスクが行われたかどうかが分かる．また，ヘモグロビンの濃度変化の平均や標準偏差などの特徴を識別することで，どのようなタスクが行われているかを把握することができる[10]．\\
　脳血流の計測の欠点として，神経活動が行われてから脳血流に変化が現れるまでにタイムラグが生じるため，時間分解能に劣っている．一方，脳血流の計測部位はNIRSの照射器と検出器の位置によるため，空間分解能に優れている．また，光を利用しているため電気ノイズや筋肉の動きによるノイズに強い．そのため，時間分解能に優れているが空間分解能には劣っており，またノイズにもあまり強くない脳波と同時に計測することが有効である[11]．\\

\section{NIRS(Near Infrared Spectroscopy)の原理}
　NIRSは生体に対して高い透過性を示す近赤外線を使用して脳血流を計測する．近赤外線は無害な光であるため，安全性が高く繰り返し使用できる．また計測中に被験者が動くことが可能であるため，実用化に向いている[12]．\\
　NIRSは近赤外線を送光する照射器と，近赤外線を受光する検出器から成り立つ．また，その二つの間をチャネルとし，そこが計測部位である[13]．NIRSの照射器と検出器と計測部位の位置関係を図2.1に示す．照射器と検出器の距離を3.0cmとすることで，大脳皮質の表面の血流を計測することができる[10]．\\
　酸化ヘモグロビンと還元ヘモグロビンの濃度変化をそれぞれ計測する方法は，光の吸収率の違いを利用する．660nmの波長で計測する際，還元ヘモグロビンは酸化ヘモグロビンより光吸収率が大きい．一方，880nmの波長で計測する際，酸化ヘモグロビンは還元ヘモグロビンより光吸収率が大きい[15]．これら二つの波長で計測した際の光の強度を，ランベルト・ベールの法則(付録A)に代入し連立方程式を解くことで，酸化・還元ヘモグロビンそれぞれの濃度変化を計算することができる．注意点として，ランベルト・ベールの法則により計算できる濃度変化の値は，絶対数値ではなく，計測を開始してからの相対数値である[10]．\\

\begin{figure}[t]
  \begin{center}
    \includegraphics[clip,width=10cm]{NIRS計測.eps}
    \caption{NIRSの照射器と検出器と計測部位(赤い部分)[14].}
    \label{fig}
  \end{center}
\end{figure}

\section{本章のまとめ}
　本章では，脳血流の特徴と，脳血流を計測する機器であるNIRSについて説明した．\\
　第2.2節「脳血流の特徴」では，脳血流の概要と，欠点である時間分解能，利点である空間分解能について説明した．\\
　第2.3節「NIRS(Near Infrared Spectroscopy)の原理」では，NIRSの様々な特徴と，酸化・還元ヘモグロビンの濃度変化を計測する原理について説明した．\\
　
\chapter{公開脳血流データセット}
\section{本章の概要}
　本章では，Shinらの研究[7]やGhafferらの研究[8]，自ら行った実験で使用したShinらにより公開されている脳血流データセット[6]の説明をする．\\
　第3.2節「公開脳血流データの特徴」では，Shinらの公開脳血流データセット[6]の特徴について述べる．\\
　第3.3節「実験内容」では，実験のタイムチャートや具体的な実験内容について述べる．\\
　第3.4節「本章のまとめ」では，本章の総括を行う．\\

\section{公開脳血流データの特徴}
　Shinらにより公開されている脳血流データセット[6]には，右手の運動イメージ，左手の運動イメージ，暗算，休憩の四項目のタスクを行った際，NIRSとEEGの二つにより同時に計測した各チャネルにおける光の強度のデータが含まれている．これらのタスクは各30回ずつ行われる．データ計測時のNIRSの照射器，検出器とチャネル，またEEGの電極の配置を図3.1に示す．またその他のデータの特徴を表3.1に示す．表3.1より被引用件数が106であり，被引用件数が100件以上となる論文は上位1\%\ であるため[16]，Shinらの公開脳血流データセット[6]は信頼性があるデータである．\\

\begin{figure}[t]
  \begin{center}
    \includegraphics[clip,width=9.5cm]{データセット配置.eps}
    \caption{NIRSの照射器(赤)，検出器(緑)とチャネル(黒線)，EEGの電極(青)と接地電極(黒丸)の配置[6].}
    \label{fig}
  \end{center}
\end{figure}

\begin{table}[hbtp]
  \caption{公開脳血流データの特徴[6]．}
  \label{table:data_type}
  \centering
  \begin{tabular}{lcr}
    \hline
    特徴  & 値  \\
    \hline \hline
    サンプリング周波数  & 12.5Hz \\
    ダウンサンプリング周波数  & 10Hz \\
    被験者数  & 29人(男性：14人　女性：15人) \\
    照射器  & 14個 \\
    検出器  & 16個\\
    チャネル  & 36個\\
    被引用件数  & 106件\\
    \hline
  \end{tabular}
\end{table}

\section{実験内容}
　Shinらの公開脳血流データセット[6]では，実験Aを左手と右手の運動イメージを計20回(各10回ずつ)，実験Bを暗算と休憩を計20回(各10回ずつ)とすると，ABABABとA，Bそれぞれ交互に3回行う．よって，左手の運動イメージ，右手の運動イメージ，暗算，休憩の各データはそれぞれ合計で30回ずつ行われる．1回分の実験のタイムチャートを図3.2に示す．実験Aのフローチャートを図3.3，実験Bのフローチャートを図3.4に示す．図3.3，3.4のInstruction，Task，Restは図3.2に対応している．図3.3のInstructionでは，←と→は各10回ずつ表示される．Taskでは矢印の向きが示す側の手を開閉する．また，1秒ごとの手の開閉のスピードを実験前に見せて，そのスピードを覚えさせる．図3.4のInstructionでは，数字と＋を各10回ずつ表示する．Taskの暗算では，まず表示された「3桁の数字」ー「1桁の数字」を計算する．その「1桁の数字」をxとし，計算結果をaとすると，a-x=b，b-x=c，c-x=d，…のように計算を繰り返す．\\

\begin{figure}[t]
  \begin{center}
    \includegraphics[clip,width=15.3cm]{データセットタイムチャート.eps}
    \caption{実験のタイムチャート[6].}
    \label{fig}
  \end{center}
\end{figure}

\begin{figure}[t]
  \begin{center}
    \includegraphics[clip,width=9cm]{フローチャート１.eps}
    \caption{実験Aのフローチャート.}
    \label{fig}
  \end{center}
\end{figure}

\begin{figure}[t]
  \begin{center}
    \includegraphics[clip,width=9cm]{フローチャート２.eps}
    \caption{実験Bのフローチャート.}
    \label{fig}
  \end{center}
\end{figure}

\section{本章のまとめ}
　本章では，第4章の先行研究紹介や第5，6章の自ら実際に行った実験で使用したShinらの公開脳血流データセット[6]について述べた．\\
　第3.2節「公開脳血流データの特徴」では，Shinらの公開脳血流データセット[6]の特徴について説明した．このデータセットの被引用件数から，信頼性があるデータであることが分かった．\\
　第3.3節「実験内容」では，データ計測の際の実験のタイムチャートや，フローチャートを用いて具体的な実験内容について述べた．\\

\chapter{先行研究紹介}
\section{本章の概要}
　本章では，Shinらの公開脳血流データセット[6]を使用している二つの先行研究について紹介する．\\
　第4.2節「Shinらの研究」では，共に運動野内である左手の運動イメージと右手の運動イメージの識別を行っているShinらの研究[7]を紹介する．\\
　第4.3節「Ghafferらの研究」では，左手の運動イメージ，右手の運動イメージ，暗算，休憩の四項目の識別を行っているGhafferらの研究[8]を紹介する．\\
　第4.4節「本章のまとめ」では，本章の総括を行う．\\

\section{Shinらの研究}
　第4.2.1「脳血流データの処理方法」では，Shinらの研究[7]で行われている，Shinらの公開脳血流データセット[6]の処理方法を紹介する．\\
　第4.2.2「実験結果と考察」では，処理された脳血流データを，SVM(Support Vector Machine)，LDA(Linear Discriminant Analysis)，RLDA(Regularized Linear Discriminant Analysis)，Bagging(Bootstrap Aggregating)(付録B)によりShinらが識別した結果を紹介し，考察を行う．\\

\subsection{脳血流データの処理方法}
　Shinらの公開脳血流データセット[6]の左手，右手の運動イメージの光の強度を，酸化ヘモグロビン，還元ヘモグロビンの濃度変化に変換するために，ランベルト・ベールの法則を適用する．\\
　光の強度から変換された酸化・還元ヘモグロビンの濃度変化に0.01Hzのハイパスフィルタをかける．この処理により，ドリフト(全体の緩やかな傾き)を除去する．さらに0.09Hzのローパスフィルタをかける．この処理により，高周波のノイズを除去する．\\
　次に，上記の処理が施された脳血流データを，各30回ずつ行われた左手の運動イメージ，右手の運動イメージの二つのタスクに分ける．その後，各10秒間のタスクの開始1秒前から終了5秒後までの16秒間の平均をとる(加算平均)．この処理により，タスクを行っていない際の脳血流の小さな変化は打ち消しあい，タスクが行われた際の脳血流の変化は残るため，識別が行いやすくなる．\\
　最後に，タスク開始の1秒前からタスク開始までの平均を全体から引くことにより，タスク開始時の脳血流変化を0に近づけ，変化量を分かりやすくする(ベースライン処理)．\\
　脳血流データを識別する方法は，以上の処理が施された脳血流データの特徴を抽出し，その特徴をグラフにプロットし，それらを識別器を用いて識別する．Shinらの研究[7]で使用している特徴は，各タスクの開始後5秒～10秒，10秒～15秒の酸化ヘモグロビンと還元ヘモグロビンの濃度変化の平均である．よって特徴の数は，2(左手の運動イメージ，右手の運動イメージ)×36(チャネル数)×2(タスク開始後5秒～10秒，10秒～15秒)×2(酸化ヘモグロビン，還元ヘモグロビン)の計288個である．これらをx軸が酸化ヘモグロビン，y軸が還元ヘモグロビンのグラフにプロットし，識別を行う．\\

\subsection{実験結果と考察}
　Shinらの研究[7]では，SVM，LDA，RLDA，Baggingにより識別を行っている．Baggingで使用する弱学習機(予測性能が高くない学習機)の数は10～50個の中から適切な数を選択している．これらの識別器による識別結果の平均を図4.1に示す．図4.1のピンクの点線はBMIとして有効な正答率(70\%\ )，黒色の点線は偶然正答する確率(60\%\ )を示している． 各識別方法による識別正答率の平均は，SVM：59.6\%\ ，LDA：57.9\%\ ，RLDA：59.1\%\ ，Bagging：62.6\%\ であり，これらは全て偶然正答する確率(60 \%\ )に近い．よって共に運動野である右手の運動イメージと左手の運動イメージの識別が難しい．\\

　\begin{figure}[t]
  \begin{center}
    \includegraphics[clip,width=13cm]{Shin識別平均.eps}
    \caption{Shinらの研究[7]の各識別方法による識別正答率の平均[7].}
    \label{fig}
  \end{center}
\end{figure}

\section{Ghafferらの研究}
　第4.2.1「脳血流データの処理方法」では，Ghafferらの研究[8]で行われている，Shinらの公開脳血流データセット[6]の処理方法を紹介する．\\
　第4.2.2「実験結果と考察」では，処理された脳血流データを，GhafferらがSVM，LDA，kNN(k-Nearest Neighbor)(k=3)により識別した結果を紹介し，考察を行う．\\

\subsection{脳血流データの処理方法}
　Shinらの公開脳血流データセット[6]は，被験者は29人，チャネル数は各被験者当たり36個であった．Ghafferらの研究[8]では，その被験者のうち5人，各被験者当たり36個のチャネルのうち，33個を使用している．しかし，研究で使用する被験者とチャネルを選択した方法についての明記はない．\\
　Shinらの公開脳血流データセット[6]の左手，右手の運動イメージ，暗算，休憩の光の強度を，酸化ヘモグロビンと還元ヘモグロビンの濃度変化に変換するために，ランベルト・ベールの法則を適用する．これらのうち，Ghafferらの研究[8]では酸化ヘモグロビンの濃度変化のみを使用する．この理由は，特徴を6つ扱うため六次元のグラフとなり，酸化ヘモグロビンと還元ヘモグロビンの二次元グラフ上に特徴をプロットできないためである．\\
　光の強度から変換された酸化・還元ヘモグロビンの濃度変化に0.01Hzのハイパスフィルタをかける．さらに0.3Hzのローパスフィルタをかける．\\
　次に，各30回ずつ行われた左手の運動イメージ，右手の運動イメージ，暗算，休憩の四つのタスクに脳血流データを分ける．その後それぞれ10秒間のタスクの開始5秒前から終了10秒後までの25秒間の加算平均を行う．\\
　識別する際の特徴として，平均，標準偏差，最大値，分散，歪度，尖度を扱う．歪度とはデータの正規分布に対するx軸方向のずれであり，計算式は以下のようになる．サンプルサイズをn，各データ$x_i$(i:1,2,3,…,n)の平均値を$\overline{x}$，標準偏差をsとする[17]．\\

\begin{equation}
\frac{n}{(n-1)(n-2)} \ \sum_{i=1}^{n} (\frac{(x_i-\overline{x})}{s})^3 \ 
\end{equation} 

　また，尖度とはデータの正規分布に対するy軸方向のずれであり，計算式は以下のようになる[17]．\\

\begin{equation}
\frac{n(n+1)}{(n-1)(n-2)(n-3)} \ \sum_{i=1}^{n} \frac{(x_i-\overline{x})^4}{s^4} \ \ - \frac{3(n-1)^2}{(n-2)(n-3)}
\end{equation}

　特徴の数は，4(左手の運動イメージ，右手の運動イメージ，暗算，休憩)×3(各実験を繰り返した数)×33(チャネル数)×6(平均，標準偏差，最大値，分散，歪度，尖度)の計2376個である．各特徴(平均，標準偏差，最大値，分散，歪度，尖度)を軸とした6次元において識別を行う．\\

\subsection{実験結果と考察}
　Ghafferらの研究[8]では，SVM，LDA，kNN(k=3)により識別を行っている．これらの識別器による識別結果の平均を図4.2に示す．各識別方法による識別正答率の平均は，LDA：72.15\%\ ，SVM：75.42\%\ ，kNN：90.54\%\ である．\\
　結果は，kNNが圧倒的に高い正答率となった．これよりkNNは4項目より識別する項目数が増えても高い正答率で識別を行える可能性がある．\\

　\begin{figure}[t]
  \begin{center}
    \includegraphics[clip,width=9cm]{Ghaffer平均.eps}
    \caption{Ghafferらの研究[8]の各識別方法による識別正答率の平均[8].}
    \label{fig}
  \end{center}
\end{figure}

\section{本章のまとめ}
　本章では，Shinらの公開脳血流データ[6]を使用しているShinらの研究[7]と，Ghafferらの研究[8]を紹介した．\\
　第4.2節「Shinらの研究」では，共に運動野内である左手の運動イメージと右手の運動イメージをSVM，LDA，RLDA，Baggingにより識別を行っている．全ての識別正答率の平均は偶然正答する確率(60\%\ )付近となったため，運動野内での識別は難しいことが分かった．\\
　第4.3節「Ghafferらの研究」では，右手の運動イメージ，左手の運動イメージ，暗算，休憩の四項目をSVM，LDA，kNNにより識別を行っている．kNNが圧倒的に高い識別正答率であったことから，kNNは4項目以上の識別の際も高い正答率で識別を行える可能性がある．\\

\chapter{脳血流データの右手、左手の運動イメージの識別方法}
\section{本章の概要}
　本章では，Shinらのデータセット[6]の公開脳血流データの左手の運動イメージと右手の運動イメージをSVM，LDA，kNN，Baggingにより自ら識別を行った．\\
　第5.2節「脳血流データの処理方法」では，識別の際に行ったデータの処理方法について述べる．\\
　第5.3節「実験結果と考察」では，左手の運動イメージと右手の運動イメージの識別結果について説明した後，考察を行う．\\
　第5.4節「本章のまとめ」では，本章の総括を行う．\\
\section{脳血流データの処理方法}
　本章で行う左手，右手の運動イメージの識別は，Shinらの研究[7]と比較を行うため，Shinらの研究[7]と同様のデータ処理を行う．\\
　まず初めに，Shinらの公開脳血流データ[6]の光の強度をランベルト・ベールの法則を適用し，酸化・還元ヘモグロビンの濃度変化へと変換する．この時，Shinらの研究[7]では全てのチャネルを使用しているが，自らの識別では負の値を含むチャネルを考慮していない．この理由は，ランベルト・ベールの法則はlogの計算を含み，logは負の値を計算できないので，負の値を含むチャネルの処理ができなかったためである．被験者1の濃度変化をプロットしたものを図5.1に示す．次に0.01Hzのハイパスフィルタと0.09Hzのローパスフィルタをかける．ハイパスフィルタをかけたもの，ローパスフィルタをかけたものをそれぞれ図5.2，図5.3に示す．そして，左手，右手の運動イメージのタスクに分け，各10秒間あるタスクの，開始1秒前から終了5秒後までの合計16秒間の加算平均を行う．最後に，タスク開始1秒前からタスク開始までの1秒間の平均を全体から引く(ベースライン処理)．左手の運動イメージと右手の運動イメージの脳血流データに加算平均とベースライン処理を行ったものをそれぞれ図5.4と図5.5に示す．\\
　識別の際に，タスク開始5秒から10秒，10秒から15秒の平均を特徴として扱う．この特徴をx軸が酸化ヘモグロビン，y軸が還元ヘモグロビンのグラフにプロットする．被験者1の特徴をプロットした様子を図5.6に示す．\\

\begin{figure}[t]
  \begin{center}
    \includegraphics[clip,width=13cm]{血流ma.eps}
    \caption{酸化・還元ヘモグロビンの濃度変化(赤が酸化ヘモグロビン，青が還元ヘモグロビン).}
    \label{fig}
  \end{center}
\end{figure}

\begin{figure}[t]
  \begin{center}
    \includegraphics[clip,width=13cm]{ハイパスma.eps}
    \caption{図5.1に対してハイパスフィルタ(0.01Hz)をかけた脳血流データ(赤が酸化ヘモグロビン，青が還元ヘモグロビン).}
    \label{fig}
  \end{center}
\end{figure}

\begin{figure}[t]
  \begin{center}
    \includegraphics[clip,width=13cm]{ローパスma.eps}
    \caption{図5.2に対してローパスフィルタ(0.09Hz)をかけた脳血流データ(赤が酸化ヘモグロビン，青が還元ヘモグロビン).}
    \label{fig}
  \end{center}
\end{figure}

\begin{figure}[t]
  \begin{center}
    \includegraphics[clip,width=11cm]{加算平均ベースライン左.eps}
    \caption{図5.3の左手の運動イメージを加算平均・ベースライン処理したデータ(赤が酸化ヘモグロビン，青が還元ヘモグロビン).}
    \label{fig}
  \end{center}
\end{figure}

\begin{figure}[t]
  \begin{center}
    \includegraphics[clip,width=11cm]{加算平均ベースライン右.eps}
    \caption{図5.3の右手の運動イメージを加算平均・ベースライン処理したデータ(赤が酸化ヘモグロビン，青が還元ヘモグロビン).}
    \label{fig}
  \end{center}
\end{figure}

\begin{figure}[t]
  \begin{center}
    \includegraphics[clip,width=13cm]{特徴.eps}
    \caption{Shinらのデータセット[6]の被験者1の特徴.}
    \label{fig}
  \end{center}
\end{figure}

\section{実験結果と考察}
　SVM，LDA，kNN(k=3)，Baggingにより識別を行った．Shinらの研究[7]で使用しているBaggingは弱識別器の数を10～50個の中から適切な数を選択しているが，その方法についての明記が無かったため，今回の実験では30個の弱識別器を使用している．図の特徴をSVM，LDAにより識別した様子を図5.7，kNN(k=3)により識別を行った様子を図5.8に示す．\\
　各識別方法により識別した結果の平均を図5.9に示す．図5.9のピンクの点線はBMIとして有効な正答率(70\%\ )，黒色の点線は偶然正答する確率(60\%\ )を示している． 各識別方法による識別正答率の平均は，LDA：68.6\%\ ，SVM：69.3\%\ ，kNN(k=3)：69.3\%\ ，Bagging：67.9\%\ である．\\
　Shinらの研究[7]では，全て偶然正答する確率(60\%\ )付近だったが，自ら行った実験では，全てBMIとして有効な正答率(70\%\ )付近となった．この理由として，負の値を含むチャネルを考慮しなかったことが考えられる．この結果から，考慮すべきチャネルを絞ることにより，さらに識別正答率が上がる可能性がある．\\
　
\begin{figure}[t]
  \begin{center}
    \includegraphics[clip,width=13cm]{LDASVM.eps}
    \caption{図5.6の特徴をLDA，SVMにより識別した様子.}
    \label{fig}
  \end{center}
\end{figure}

\begin{figure}[t]
  \begin{center}
    \includegraphics[clip,width=13cm]{kNN.eps}
    \caption{図5.6の特徴をkNN(k=3)により識別した様子.}
    \label{fig}
  \end{center}
\end{figure}

\begin{figure}[t]
  \begin{center}
    \includegraphics[clip,width=11cm]{二項目識別比較.eps}
    \caption{左手，右手の運動イメージの識別結果の平均の比較.}
    \label{fig}
  \end{center}
\end{figure}

\section{本章のまとめ}
　本章では，Shinらの公開脳血流データ[6]の左手の運動イメージ，右手の運動イメージをSVM，LDA，kNN(k=3)，Baggingにより識別を行った．\\
　第5.2節「脳血流データの処理方法」では，Shinらの研究[7]と比較をするため，Shinらの研究[7]と同様の処理を行った．\\
　第5.3節「実験結果と考察」では，識別する際に負の値を含むチャネルを考慮しない事で，Shinらの研究[7]より高い識別正答率となった．このことから，識別に使用すべきチャネルを選択することでより高い正答率で識別を行える可能性がある．\\

\chapter{脳血流データの右手、左手の運動イメージ、暗算、休憩の識別方法}
\section{本章の概要}
　本章では，Shinらのデータセット[6]の公開脳血流データの左手の運動イメージ，右手の運動イメージ，暗算，休憩の四項目をSVM，LDA，kNN(k=3)，Baggingにより自ら識別を行った．\\
　第6.2節「脳血流データの処理方法」では，識別を行う際に行ったデータの処理方法について述べる．\\
　第6.3節「実験結果と考察」では，左手の運動イメージ，右手の運動イメージ，暗算，休憩の四項目の識別結果について説明した後，考察を行う．\\
　第6.4節「本章のまとめ」では，本章の総括を行う．\\

\section{脳血流データの処理方法}
　本章で行う四項目の識別は，Ghafferらの研究[8]と比較を行うため，Ghafferらの研究[8]と同様のデータ処理を行う．Ghafferらの研究[8]では，29人中5人の被験者，36個中33個のチャネルを使用しているが、どの被験者やチャネルを使用しているかの明記がないため，本章で行う識別では，29人の被験者，36個のチャネルを使用している．\\
　まず初めに，ランベルト・ベールの法則により光の強度を酸化・還元ヘモグロビンの濃度変化に変換する．この際，第5章同様に負の値を含むチャネルは使用していない．次に0.01Hzのハイパスフィルタ，0.3Hzのローパスフィルタをかける．その後，各タスクにおいてタスク開始5秒前からタスク開始後20秒までの25秒間の加算平均を行う．\\
　識別に使用する特徴として，平均，標準偏差，最大値，分散，歪度，尖度の6個を扱う．\\

\section{実験結果と考察}
　SVM，LDA，kNN(k=3)，Baggingにより識別を行った．第5章と同様に，Baggingの弱識別器の数は30個である．各識別方法により識別した結果の平均を図6.1に示す．各識別方法による識別正答率の平均は，LDA：56.1\%\ ，SVM：66.0\%\ ，kNN(k=3)：92.3\%\ ，Bagging：91.3\%\ である．\\
　実験結果より，Ghafferらの研究[8]と同様にLDAとSVMはあまり高い正答率ではなかったが，kNN(k=3)は90\%\ を超える高い正答率となった．また，Baggingも高い正答率となった．よって，kNNとBaggingは多くの項目の識別に向いていると考えられる．\\
　これらの結果から，NIRSを用いたBMIの実用化を実現するための課題である，さらに多くの項目の識別を行う際に，kNNとBaggingが有効である可能性がある．\\

\begin{figure}[t]
  \begin{center}
    \includegraphics[clip,width=11cm]{四項目比較.eps}
    \caption{左手，右手の運動イメージ，暗算，休憩の識別結果の平均の比較.}
    \label{fig}
  \end{center}
\end{figure}

\section{本章のまとめ}
　本章では，Shinらの公開脳血流データ[6]の左手の運動イメージ，右手の運動イメージ，暗算，休憩の四項目をSVM，LDA，kNN(k=3)，Baggingにより識別を行った．\\
　第5.2節「脳血流データの処理方法」では，Ghafferらの研究[8]と比較をするため，Ghafferらの研究[8]と同様の処理を行った．\\
　第5.3節「実験結果と考察」では，四項目の識別においてkNNとBaggingで90\%\ を超える正答率となった．このことから，さらに種類の多い項目を識別する際に，kNNとBaggingが有効であることが分かった．\\

\chapter{結論}
　本論文では，脳血流データによる最大四項目の思考タスクを複数の方法で識別し，考察した結果について述べた．\\
　第1章「序論」では，本論文の背景と目的について述べた．BMIに用いる脳波や脳血流の計測方法が様々ある中で，小型であり移動しながらの計測が可能であるという点から，脳波を計測するEEGと脳血流を計測するNIRSが，BMIの実用化に適していると述べた．NIRSはまだ数多くの研究が行われておらず，また二項目より多い項目数の識別に関する先行研究も数が少ないため，NIRSにより計測された脳血流データによる二項目より多い項目数の識別が必要である．よって本論文では，脳血流データによる四項目の思考タスク(右手の運動イメージ，左手の運動イメージ，暗算，休憩)を高い精度で識別することを目的とした．\\
　第2章「脳血流とNIRS」では，近年BMIに使用されている脳血流の特徴と，脳血流の計測に使用する機器であるNIRSについて述べた．\\
　第3章「公開脳血流データセット」では，Shinらの研究[7]，Ghafferらの研究[8]や，自ら行った研究で使用したデータセットについて紹介した．\\
　第4章「先行研究紹介」では，Shinらの研究[7]と，Ghafferらの研究[8]を紹介した．Shinらの研究[7]では，共に運動野である左手，右手の運動イメージの識別を行っている．SVM，LDA，RLDA，Baggingの全てにおいて識別正答率が偶然正答する確率(60\%\ )に近く，運動野内の識別が難しいことが分かった．Ghafferらの研究[8]では，左手，右手の運動イメージ，暗算，休憩の四項目の思考タスクの識別を行っている．実験結果は，kNNが四項目の識別において約90\%\ という高い識別正答率であった．\\
　第5章「脳血流データの右手，左手の運動イメージの識別方法」では，左手の運動イメージと右手の運動イメージの二項目をLDA，SVM，kNN，Baggingにより識別を行った．Shinらの研究[7]では，この二項目の識別正答率は偶然正答する確率(60\%\ )だったが，自ら行った二項目の識別では全ての識別正答率が約70\%\ となった．Shinらの研究[7]の結果と差が生じた理由は，自ら行った実験ではデータを処理する際に負の値の光の強度を含むチャネルを考慮しなかったからと結論付けた．この結果より，識別に使用するチャネルを選択することで，さらに識別正答率を向上できる可能性がある．\\
　第6章「脳血流データの右手，左手の運動イメージ，暗算，休憩の識別方法」では，左手の運動イメージ，右手の運動イメージ，暗算，休憩の四項目をLDA，SVM，kNN，Baggingにより識別を行った．kNNとBaggingで90\%\ を超える高い識別正答率であった．そのため，さらに項目数が増えた際，kNNとBaggingを使用することで高い正答率で識別を行える可能性がある．\\
　本論文では，NIRSの先行研究であまり行われていない，四項目の思考タスクの識別において90\%\ 以上という高い識別正答率を達することに成功した．\\
　今後の展望として，NIRSによるBMIの実用化に向けて，映像のイメージ，下半身の運動イメージなどの脳血流データを計測し，識別項目を増やしていく必要がある．\\

\gratitude
　本論文を執筆するにあたり貴重な御指導，御助言をくださった本電子物理システム学科，柳澤政生教授に深く感謝申し上げます．\\
　また，日々の研究や資料作成において指導してくださり，本論文に関しても多くの助言をくださった樋口成亮氏に感謝申し上げます．\\
　また，ゼミや日々の研究活動で支えて頂きました，柳澤研究室，史研究室，木村研究室，吉増研究室の皆様に感謝申し上げます．\\
\begin{thebibliography}{99}
\bibitem{小原01}里宇明元，“Brain machine interfaceのリハビリテーション医学への応用，”　Igaku no Ayumi，vol．264，no．13．pp．1164- 1170，2018．\\
\bibitem{小原01}井上芳浩，“NIRS-EEGを用いた非侵襲BMI，”　Igaku no Ayumi，vol．245，no．10，pp．889- 894，2013．\\
\bibitem{小原01}有住なな，“ブレイン・コンピュータ・インターフェース概説，”　Communications of the Operations Research Society of Japan，vol．60，no．10，pp．227- 233， 2015．\\
\bibitem{小原01}Nazeer Hammad, Naseer Noman, Mehboob Aakif, Khan Muhammad Jawad, Khan Rayyan Azam, Khan Umar Shahbaz, and Ayaz Yasar, ``Enhancing Classification Performance of fNIRS-BCI by Identifying Cortically Active Channels Using the z-Score Method," Sensors, vol. 20, no. 23, p. 1 -20, 2021.\\
\bibitem{小原01}柳沢一機，澤井英征，綱島均，“NIRS-BCI リハビリテーションシステムのための脳活動判定法，”　日本機械学会論文集，vol．79，no．797，pp．43- 55，2013．\\
\bibitem{小原01}Shin Jaeyoung, Von Luhmann Alexander, Blankertz Benjamin, Kim Do-Won, Jeong Jichai, Hwang Han-Jeong, and Muller Klaus-Robert, ``Open Access Dataset for EEG+NIRS Single-Trial Classification," IEEE Transactions on Neural Systems and Nehabilitation Engineering, vol. 25, no. 10, pp. 1735- 1745, 2017.\\
\bibitem{小原01}Shin Jaeyoung and Im Chang-Hwan, ``Performance Improvement of Near-Infrared Spectroscopy-Based Brain-Computer Interface Using Regularized Linear Discriminant Analysis Ensemble Classifier Based on Bootstrap Aggregating," Frontiers in Neuroscience, vol. 14, pp. 1- 11, 2020.\\
\bibitem{小原01}Bin Abdul Ghaffar, Muhammad Saad Khan, Umar S Naseer, Noman Rashid, Nasir Tiwana, and Mohsin Islam, ``Improved Classification Accuracy of Four Class FNIRS-BCI," 12th International Conference on Electronics, Computers and Artificial Intelligence (ECAI), pp. 1- 5, 2020.\\
\bibitem{小原01}小野哲治，伊藤憲治，関本荘太郎，角田晃一，“Near-infrared spectroscopy (NIRS)を用いたBrain-Machine Interface (BMI)システムにおけるセンサ装着位置の検討，”　群馬パース大学紀要，vol．25，pp．3- 12，2020．\\
\bibitem{小原01}小野弓絵，“MATLABで学ぶ生体信号処理，”　コロナ社，pp．101- 124，2018．
\bibitem{小原01}Shin Jaeyoung, von Lühmann Alexander, Kim Do-Won, Mehnert Jan, Hwang Han-Jeong, and Müller Klaus-Robert, ``Simultaneous Acquisition of EEG and NIRS During Cognitive Tasks for an Open Access Dataset," Scientific data, vol.5, pp. 1- 16, 2018.
\bibitem{小原01}高倉大匡，“近赤外線分光法，”　Equilibrium Research，vol．74，pp．552- 556，2015．
\bibitem{小原01}栗田太作，寺尾保，瀧澤俊也，“低酸素運動における前頭部多チャンネルNIRS と前額部パルスオキシメータの同時測定の試み，”　東海大学スポーツ医科学雑誌，pp. 79- 87，2013．
\bibitem{小原01}心の風クリニック，“光トポグラフィー検査について，”　https://k-kaze.jp/topo/，accessed:2022/1/16．
\bibitem{小原01}SYSMEX，“基礎データ集，”　https://sysmex-astrim.jp/wp-content/uploads/2014/04/c2069ec0dc0f1162f4167103fd5f0e3b.pdf，accessed:2022/1/16．
\bibitem{小原01}木村光，“研究者の楽しみ(随縁随意)，”　生物工学会誌，vol．90，2012．
\bibitem{小原01}BellCurve，“歪度と尖度，”　https://bellcurve.jp/statistics/course/17950.html，accessed:2022/1/21．
\bibitem{小原01}株式会社島津製作所，“近赤外光イメージング装置（光トポグラフィー検査対応），”　https://www.med.shimadzu.co.jp/products/om/qa03.html，accessed:2022/1/22．
\bibitem{小原01}Daiki，“バギングって何ですか？目で見てわかるメリットとは，”　https://www.investor-daiki.com/it/ai/bagging，accessed:2022/1/23．
\bibitem{小原01}VARISTA，“アンサンブル学習，”　https://www.varista.ai/knowledge/ensemble-learning/，accessed:2022/1/23．
\bibitem{小原01}DATA VIZ LAB，“過学習とは？初心者向けに理由から解決法までわかりやすく解説，”　https://data-viz-lab.com/overfitting，accessed:2022/1/23．
\end{thebibliography}

\appendix
\chapter{ランベルト・ベールの法則}
　NIRSにより計測された光の強度はランベルト・ベールの法則により酸化ヘモグロビン，還元ヘモグロビンの濃度変化に変換することができる．付録Aでは，酸化・還元ヘモグロビンの濃度変化を求める際の計算について述べる．入射光強度を$I_{in}$，検出光強度をI，ヘモグロビンの吸光係数を$\epsilon$ ，ヘモグロビンの濃度をc，光が進んだ距離をd，光の散乱による減衰をsとする．そのイメージ図を図A.1に示す．以下にランベルト・ベールの法則の式を示す．\\

\begin{equation}
-log_{10}(\frac{I}{I_{in}}) = \epsilon cd+s	
\end{equation}

　次にヘモグロビンの濃度変化がcからc+Δc，検出光がIからI+ΔIに変化したとすると式(A.1)と同様に次の式が成り立つ．\\

\begin{equation}
-log_{10}(\frac{I+ΔI}{I_{in}}) = \epsilon (c+Δc)d+s 	
\end{equation}			

　式(A.2)から式(A.1)を引くと次の式が成り立つ．\\

\begin{equation}
-log_{10}(\frac{I+ΔI}{I_{in}}) = \epsilon Δcd 
\end{equation}			

　ヘモグロビンには酸化ヘモグロビンと還元ヘモグロビンの二種類があり，それぞれ別の吸光係数$\epsilon_{oxy}$と$\epsilon_{deoxy}$を持つ．また，酸化ヘモグロビンと還元ヘモグロビンの濃度を$c_{oxy}$と$c_{deoxy}$とする．近赤外線の波長を$\lambda$とし，ΔA=$-log_{10}(\frac{I+ΔI}{I_{in}})$とすると，次の式が成り立つ．\\

\begin{equation}
ΔA(\lambda)=(\epsilon_{oxy}(\lambda)Δc_{oxy}+\epsilon_{deoxy}(\lambda)Δc_{deoxy})d 			
\end{equation}

　酸化ヘモグロビンの濃度変化の$Δc_{oxy}$と還元ヘモグロビンの濃度変化の$Δc_{deoxy}$を求めるには，二種類の波長で計算する必要がある．波長$\lambda_1$と$\lambda_2$を用いた時の計算式を次に示す．\\

\begin{equation}
\left(\begin{array}{c} ΔA(\lambda_1) \\ ΔA(\lambda_2) \\ \end{array}\right)=\left(\begin{array}{cc} \epsilon_{oxy}(\lambda_1) & \epsilon_{deoxy}(\lambda_1) \\ \epsilon_{oxy}(\lambda_2) & \epsilon_{deoxy}(\lambda_2) \\ \end{array}\right)\left(\begin{array}{c} Δc_{oxy} \\ Δc_{deoxy} \\ \end{array}\right)d
\end{equation}

　式(A.5)をA=EΔCdとおき，$E^-1$を左からかけることで光の進んだ距離を含む酸化・還元ヘモグロビンの濃度変化ΔCdを求めることができる[10]．\\

\begin{figure}[t]
  \begin{center}
    \includegraphics[clip,width=10cm]{ランベルト・ベールの法則.eps}
    \caption{ランベルト・ベールの法則のイメージ図[18].}
    \label{fig}
  \end{center}
\end{figure}

\chapter{Bagging}
　Baggingはアンサンブル学習の一部である．アンサンブル学習とは，弱学習機(予測性能が高くない学習機)を組み合わせる手法である．アンサンブル学習の主な例として，BaggingとBoostingが存在する．Baggingのイメージ図を図B.1に示す．Baggingとは，図B.1のように訓練データから重複を許してランダムにデータを抽出し，それぞれを弱学習機により識別し，その多数決により識別結果を求めるというものである[19]．\\
　Baggingの長所は，いくつかの弱学習機により並列に識別を行うため計算速度が速い傾向にある．また過学習が起こりにくい[20]．過学習とは，モデル作成の際にデータを学習しすぎることで，一つ一つのデータに重きを置きすぎてしまい全体の傾向をつかめず，予測モデルとしては適していないモデルを作成してしまうことである[21]．Baggingの短所は，Boostingより識別精度が劣る傾向にある点である[20]．\\
\begin{figure}[t]
  \begin{center}
    \includegraphics[clip,width=9.6cm]{バギング.eps}
    \caption{Baggingのイメージ図[19].}
    \label{fig}
  \end{center}
\end{figure}

\end{document}

\makecover